##IBMBigDataCertification - Analysis of Medicare Plans

##Introduction

##Problem Statment
Several Medicare plans are available for senior citizens and other qualified members to enrol into every year, that are offered by different health insurance companies offering these plans. While a lot of information regarding individual plans exist, it is difficult to compare plans based on various criteria to make an informed choice to suit unique situations of individual members as well as for plan benefit designers to compare plans and design benefits that meets unique requirements and are competitive in different markets. The purpose of this document is to detail the analysis of the medicare plans data across US and provide useful summary details.
	•	Motivation
	•	The primary purpose of this project is to facilitate analysis of Medicare plans to provide meaningful insights that help in choosing appropriate medicare plans by comparing all relevant details regarding these plans that are available in each counties throughout the country.
	•	While CMS provides rich details on all the plans that are offered county wise, it makes better analysis when each plans that are offered are compared  on the finer descriptions of its cost and coverage details
	•	Objectives
	•	To implement an efficient system to extract , load and transform all data related to Medicare plans to perform analytics.
	•	Analysis of Medicare plans to compare plan offerings by various criteria’s to select suitable plan for the Members
	•	Analysis of Medicare plans to compare plan offerings to design suitable benefit plan for different regions
	•	Analysis Required for this project

	•	Identify top 5 plans with lowest premiums for a given county across the  US
	•	To find plans that have highest co-pays for doctors in a given county
	•	To compare plans based on features like plans that offer free ambulance services
	•	To compare plans based on  features like the benefits available for diabetes under specific plan
	•	To compare plan benefits on diabetes and mental healthcare offered by all companies in a particular county
##Solution Architecture
#Architecture Components
The proposed solution uses Hadoop framework and its eco-system tools to implement a distributed storage and processing of all data to perform the analysis.
Client Machine: The medicare files will be downloaded from medicare internet location onto client machine.
HDFS: The downaloded files will be uploaded onto Hadoop Distributed Files System.  The files are uploaded onto Cloudera VM ware which runs in Psudonode mode.
PIG: The raw medicare files on the HDFS will be cleansed and transformed on HDFS and spooled into CSV files on HDFS location using Pig Latin Scripts.
HIVE: The Partioned HIVE tables are built over the cleansed medicare plan info and plan services CSV files that are stored in HDFS which were generated by pig latin scripts.

SQOOP:Squoop can be used to export out the Analyzed summary data stored in HIVE tables to traditional RDBMS.

#System Requirements
Softwares: Pig Latin, HIVE, Sqoop and WINSCP
Hardware: Cloudera VM ware
Cluster: Psudo mode Cluster
Libraries:

#Data Source
The medicare data can be downloaded from medicare government website from the following location:
https://www.medicare.gov/download/downloaddb.asp
Specifically the following two CSV files consists of the plan information and plan services data from where the analysis of the data can be performed:
	•	PlanInfoCounty_FipsCodeMoreThan30000
This file contains the contractid, planid, segmented, planname and county ID where the county ID is more than 30000.  The sample of the plan info table:
"H0022","001","0","2015","Buckeye Health Plan - MyCareOhio","Buckeye Health Plan - MyCareOhio (Medicare-Medicaid Plan)","","Cleveland  Dayton  Toledo and surrounding counties","1","For Profit","Con Fines de Lucro","48","Medicare-Medicaid Plan","http://mmp.bchpohio.com","","www.bchpohio.com","www.bchpohio.com","Approved by Medicare and Medicaid","Aprobadopor Medicare y Medicaid","FALSE","TRUE","FALSE","88","&nbsp;","","","<ul><li>This is a Medicare-Medicaid plan for people with both Medicare and Medicaid.  Contact the plan for details.</li></ul>","","","","BUCKEYE COMMUNITY HEALTH PLAN  INC.","","","","","4349 Easton Way  Suite 200","Columbus","OH","43219","nslee@centene.com","1-866-549-8289","1-866-549-8289","711","711","nslee@centene.com","1-866-549-8289","1-866-549-8289","711","711","","4349 Easton Way  Suite 200","Columbus","OH","43219","nslee@centene.com","1-866-549-8289","1-866-549-8289","711","711","nslee@centene.com","1-866-549-8289","1-866-549-8289","711","711","FALSE","FALSE","0","Not SNP","No hay planes para necesidades especiales","$0.00","$0.00","$0.00","$0.00","FALSE","39023"
"H0022","001","0","2015","Buckeye Health Plan - MyCareOhio","Buckeye Health Plan - MyCareOhio (Medicare-Medicaid Plan)","","Cleveland  Dayton  Toledo and surrounding counties","1","For Profit","Con Fines de Lucro","48","Medicare-Medicaid Plan","http://mmp.bchpohio.com","","www.bchpohio.com","www.bchpohio.com","Approved by Medicare and Medicaid","Aprobadopor Medicare y Medicaid","FALSE","TRUE","FALSE","88","&nbsp;","","","<ul><li>This is a Medicare-Medicaid plan for people with both Medicare and Medicaid.  Contact the plan for details.</li></ul>","","","","BUCKEYE COMMUNITY HEALTH PLAN  INC.","","","","","4349 Easton Way  Suite 200","Columbus","OH","43219","nslee@centene.com","1-866-549-8289","1-866-549-8289","711","711","nslee@centene.com","1-866-549-8289","1-866-549-8289","711","711","","4349 Easton Way  Suite 200","Columbus","OH","43219","nslee@centene.com","1-866-549-8289","1-866-549-8289","711","711","nslee@centene.com","1-866-549-8289","1-866-549-8289","711","711","FALSE","FALSE","0","Not SNP","No hay planes para necesidades especiales","$0.00","$0.00","$0.00","$0.00","FALSE","39035"
	•	PlanInfoCounty_FipsCodeLessThan30000
This file contains the contractid, planid, segmented, planname and county ID where the county ID is less than 30000.  The sample data of the plan info table:
"H0028","001","0","2015","CHA HMO  Inc.","Humana Gold Plus H0028-001 (HMO)","","Cedar Rapids Metro Area","1","For Profit","Con Fines de Lucro","1","HMO","www.humana-medicare.com","www.humana.com","https://www.humana.com/pharmacy/medicare/tools/druglist/","https://www.humana.com/pharmacy/medicare/","Approved by Medicare","Aprobadopor Medicare","FALSE","TRUE","FALSE","88","&nbsp;","","","<ul><li>This plan does not charge an annual deductible for all drugs.  The $320 annual deductible only applies to drugs on certain tiers.</li></ul>","","","","CHA HMO  INC.","","1501-2000 physicians and providers.","1501-2000 médicos y proveedores.","","500 West Main Street","Louisville","KY","40202","HumanaOCS@humana.com","1-800-833-2364","1-800-833-2364","711","711","","1-800-457-4708","1-800-457-4708","711","711","","500 West Main Street","Louisville","KY","40202","HumanaOCS@humana.com","1-800-833-2364","1-800-833-2364","711","711","","1-800-457-4708","1-800-457-4708","711","711","FALSE","FALSE","0","Not SNP","No hay planes para necesidades especiales","$0.00","$0.00","$0.00","$0.00","FALSE","19011"
"H0028","001","0","2015","CHA HMO  Inc.","Humana Gold Plus H0028-001 (HMO)","","Cedar Rapids Metro Area","1","For Profit","Con Fines de Lucro","1","HMO","www.humana-medicare.com","www.humana.com","https://www.humana.com/pharmacy/medicare/tools/druglist/","https://www.humana.com/pharmacy/medicare/","Approved by Medicare","Aprobadopor Medicare","FALSE","TRUE","FALSE","88","&nbsp;","","","<ul><li>This plan does not charge an annual deductible for all drugs.  The $320 annual deductible only applies to drugs on certain tiers.</li></ul>","","","","CHA HMO  INC.","","1501-2000 physicians and providers.","1501-2000 médicos y proveedores.","","500 West Main Street","Louisville","KY","40202","HumanaOCS@humana.com","1-800-833-2364","1-800-833-2364","711","711","","1-800-457-4708","1-800-457-4708","711","711","","500 West Main Street","Louisville","KY","40202","HumanaOCS@humana.com","1-800-833-2364","1-800-833-2364","711","711","","1-800-457-4708","1-800-457-4708","711","711","FALSE","FALSE","0","Not SNP","No hay planes para necesidades especiales","$0.00","$0.00","$0.00","$0.00","FALSE","19019"


	•	vwPlanServices
This file contains the contractid, category description, category code and benefit information.  The sample data of the plan services table:
English,2015,H0001,001,0,Monthly Premium  Deductible  and Limits on How Much You Pay for Covered Services,1,In 2015 the monthly Part B Standard Premium is <b>$104.90</b>,Base Plan,000,1
Spanish,2015,H0001,001,0,Prima Mensual  Deducible y Límites a la Cantidad que UstedPagaporlosServicios Cubiertos,1,La prima estándar que pagapor la Parte B en el 2015 es<b>$104.90</b>,Plan Básico,000,1

##Project Work Flow
##Source Files
The source files were downloaded from the medicare government website on to the client machine and decompressed to CSV files.
HDFS
The files from the client machine are uploaded onto HDFS using the Hadoop FS commands.  As the files are sample medicare files and uploaded onto psudo mode of cloudera VM ware all the files are stored on a single data node on HDFS.
Clean up files using PIG Latin Scripts
	•	The data in the plan info and plan services files had double quotes enclosed around each field.  The files were cleaned using the pig scripts which will be listed in next section.
	•	The data in the plan services file had 2 rows for each record one in English and other in Spanish.  The files was cleaned using a separate relation in the pig script.
	•	Plan Info & Plan services files were filtered with records where contractId, SegmentId, PlanId&CountyId were null using pig scripts.  The details will be listed in next section.
HIVE tables to analyze tables:
Hive tables were built with the cleaned output files from the pig latin scripts.  A custom JAVA code was written to order the filtered records into ascending or descenting order.  The custom code was compiled into a JAR file and was deployed onto HDFS.  The JAR files was added onto HIVE and the summary queries were developed.
Export Data using Sqoop:
The summary files data from HIVE tables can be exported out of HDFS into traditional databases using the Sqoop.  However, this step is not in the scope of the project but can be included in the future use cases.
Analysis Performed
The following are some of the analysis performed
	•	Grouping the plans based on companies managing the plans and the counties where offered.
	•	Finding plans that offer specific services like free ambulance service in its coverage descriptions.
	•	Comparing plans based on the benefits offered for specific conditions like Diabetes
	•	Comparing plans based on premiums and co-pays for specific coverage criteria like doctors co-pays
	•	Comparing plans based on premiums for specific coverage criteria like doctors co-pays
